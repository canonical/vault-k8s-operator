[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  vault-b/0 [idle] active: 
  vault-b/2 [idle] active: 
  vault-b/1 [idle] active: 
[32mINFO    [0m juju.model:model.py:3211 Waiting for model:
  vault-b/0 [idle] active: 
  vault-b/2 [idle] active: 
  vault-b/1 [idle] active:
[32mINFO    [0m pytest_operator.plugin:plugin.py:929 Model status:

Model                  Controller                Cloud/Region        Version  SLA          Timestamp
test-integration-kdk1  github-pr-85bba-microk8s  microk8s/localhost  3.6.2    unsupported  03:32:01Z

App        Version  Status  Scale  Charm      Channel  Rev  Address         Exposed  Message
vault-b             active      3  vault-k8s             1  10.152.183.167  no       
vault-k8s           active      3  vault-k8s             0  10.152.183.24   no       

Unit          Workload  Agent      Address     Ports  Message
vault-b/0*    active    executing  10.1.53.13         
vault-b/1     active    executing  10.1.53.10         
vault-b/2     active    executing  10.1.53.4          
vault-k8s/0*  active    executing  10.1.53.17         
vault-k8s/1   active    executing  10.1.53.25         
vault-k8s/2   active    executing  10.1.53.23         

[32mINFO    [0m pytest_operator.plugin:plugin.py:935 Juju error logs:

unit-vault-k8s-1: 03:04:10 ERROR unit.vault-k8s/1.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-1.vault-k8s-endpoints.test-integration-kdk1.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x71330b9a7d00>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-3: 03:05:31 ERROR unit.vault-k8s/3.juju-log vault-peers:0: Raft cluster is not healthy. {'failure_tolerance': 1, 'healthy': False, 'leader': 'test-integration-kdk1-vault-k8s/0', 'servers': {'test-integration-kdk1-vault-k8s/0': {'id': 'test-integration-kdk1-vault-k8s/0', 'name': 'test-integration-kdk1-vault-k8s/0', 'address': 'vault-k8s-0.vault-k8s-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '0s', 'last_term': 3, 'last_index': 130, 'healthy': True, 'stable_since': '2025-02-03T03:02:09.169724084Z', 'status': 'leader', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-k8s/1': {'id': 'test-integration-kdk1-vault-k8s/1', 'name': 'test-integration-kdk1-vault-k8s/1', 'address': 'vault-k8s-1.vault-k8s-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '3.399646289s', 'last_term': 3, 'last_index': 128, 'healthy': True, 'stable_since': '2025-02-03T03:03:09.169889413Z', 'status': 'voter', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-k8s/2': {'id': 'test-integration-kdk1-vault-k8s/2', 'name': 'test-integration-kdk1-vault-k8s/2', 'address': 'vault-k8s-2.vault-k8s-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '4.614278455s', 'last_term': 3, 'last_index': 128, 'healthy': True, 'stable_since': '2025-02-03T03:03:11.171212131Z', 'status': 'voter', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-k8s/3': {'id': 'test-integration-kdk1-vault-k8s/3', 'name': 'test-integration-kdk1-vault-k8s/3', 'address': 'vault-k8s-3.vault-k8s-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '1.08364825s', 'last_term': 0, 'last_index': 0, 'healthy': False, 'stable_since': '2025-02-03T03:05:29.170570289Z', 'status': 'non-voter', 'version': '1.16.3', 'node_type': 'voter'}}, 'voters': ['test-integration-kdk1-vault-k8s/0', 'test-integration-kdk1-vault-k8s/1', 'test-integration-kdk1-vault-k8s/2']}
unit-prometheus-k8s-0: 03:19:24 ERROR unit.prometheus-k8s/0.juju-log metrics-endpoint:10: Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:19:25 ERROR unit.prometheus-k8s/0.juju-log metrics-endpoint:10: Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:19:28 ERROR unit.prometheus-k8s/0.juju-log metrics-endpoint:10: Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:19:30 ERROR unit.prometheus-k8s/0.juju-log metrics-endpoint:10: Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:19:31 ERROR unit.prometheus-k8s/0.juju-log metrics-endpoint:10: Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:22:36 ERROR unit.prometheus-k8s/0.juju-log Failed to apply resource limit patch: Unauthorized
unit-loki-k8s-0: 03:25:59 ERROR unit.loki-k8s/0.juju-log Failed to apply resource limit patch: Unauthorized
unit-loki-k8s-0: 03:25:59 ERROR unit.loki-k8s/0.juju-log Failed to apply resource limit patch: Unauthorized
unit-prometheus-k8s-0: 03:26:04 ERROR juju.worker.uniter pebble poll failed for container "prometheus": failed to send pebble-ready event: terminated
unit-loki-k8s-0: 03:26:14 ERROR unit.loki-k8s/0.juju-log Failed to apply resource limit patch: Unauthorized
unit-loki-k8s-0: 03:26:14 ERROR juju.worker.uniter pebble poll failed for container "node-exporter": failed to send pebble-ready event: terminated
unit-loki-k8s-0: 03:26:15 ERROR juju.worker.uniter container "node-exporter": WaitNotices error, waiting 1s: cannot communicate with server: Get "http://localhost/v1/notices?timeout=30s": EOF
controller-0: 03:27:42 ERROR juju.worker.caasunitprovisioner stopping application worker for minio: Operation cannot be fulfilled on statefulsets.apps "minio": StorageError: invalid object, Code: 4, Key: /registry/statefulsets/test-integration-kdk1/minio, ResourceVersion: 0, AdditionalErrorMsg: Precondition failed: UID in precondition: 7f0cb301-8796-4a86-9017-7d98c54a6eef, UID in object meta: 
unit-vault-b-2: 03:30:41 ERROR unit.vault-b/2.juju-log vault-autounseal-requires:13: Raft cluster is not healthy. {'failure_tolerance': 0, 'healthy': False, 'leader': 'test-integration-kdk1-vault-b/0', 'servers': {'test-integration-kdk1-vault-b/0': {'id': 'test-integration-kdk1-vault-b/0', 'name': 'test-integration-kdk1-vault-b/0', 'address': 'vault-b-0.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '0s', 'last_term': 3, 'last_index': 98, 'healthy': True, 'stable_since': '2025-02-03T03:28:58.517264295Z', 'status': 'leader', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-b/1': {'id': 'test-integration-kdk1-vault-b/1', 'name': 'test-integration-kdk1-vault-b/1', 'address': 'vault-b-1.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '4.398075245s', 'last_term': 0, 'last_index': 0, 'healthy': False, 'stable_since': '2025-02-03T03:30:36.517766628Z', 'status': 'non-voter', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-b/2': {'id': 'test-integration-kdk1-vault-b/2', 'name': 'test-integration-kdk1-vault-b/2', 'address': 'vault-b-2.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '5.294983086s', 'last_term': 0, 'last_index': 0, 'healthy': False, 'stable_since': '2025-02-03T03:30:36.517766628Z', 'status': 'non-voter', 'version': '1.16.3', 'node_type': 'voter'}}, 'voters': ['test-integration-kdk1-vault-b/0']}
unit-vault-b-1: 03:30:42 ERROR unit.vault-b/1.juju-log vault-autounseal-requires:13: Raft cluster is not healthy. {'failure_tolerance': 0, 'healthy': False, 'leader': 'test-integration-kdk1-vault-b/0', 'servers': {'test-integration-kdk1-vault-b/0': {'id': 'test-integration-kdk1-vault-b/0', 'name': 'test-integration-kdk1-vault-b/0', 'address': 'vault-b-0.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '0s', 'last_term': 3, 'last_index': 98, 'healthy': True, 'stable_since': '2025-02-03T03:28:58.517264295Z', 'status': 'leader', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-b/1': {'id': 'test-integration-kdk1-vault-b/1', 'name': 'test-integration-kdk1-vault-b/1', 'address': 'vault-b-1.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '4.398075245s', 'last_term': 0, 'last_index': 0, 'healthy': False, 'stable_since': '2025-02-03T03:30:36.517766628Z', 'status': 'non-voter', 'version': '1.16.3', 'node_type': 'voter'}, 'test-integration-kdk1-vault-b/2': {'id': 'test-integration-kdk1-vault-b/2', 'name': 'test-integration-kdk1-vault-b/2', 'address': 'vault-b-2.vault-b-endpoints.test-integration-kdk1.svc.cluster.local:8201', 'node_status': 'alive', 'last_contact': '5.294983086s', 'last_term': 0, 'last_index': 0, 'healthy': False, 'stable_since': '2025-02-03T03:30:36.517766628Z', 'status': 'non-voter', 'version': '1.16.3', 'node_type': 'voter'}}, 'voters': ['test-integration-kdk1-vault-b/0']}
unit-vault-b-0: 03:31:07 ERROR unit.vault-b/0.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-b-0.vault-b-endpoints.test-integration-kdk1.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7b90b4105330>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-b-1: 03:31:34 ERROR unit.vault-b/1.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-b-1.vault-b-endpoints.test-integration-kdk1.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x770e0d196fe0>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-b-2: 03:31:34 ERROR unit.vault-b/2.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-b-2.vault-b-endpoints.test-integration-kdk1.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7d298c1624a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-b-0: 03:31:37 ERROR unit.vault-b/0.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-b-0.vault-b-endpoints.test-integration-kdk1.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f44569bdc60>: Failed to establish a new connection: [Errno 111] Connection refused'))

[32mINFO    [0m pytest_operator.plugin:plugin.py:1041 Resetting model test-integration-kdk1...
[32mINFO    [0m pytest_operator.plugin:plugin.py:1030    Destroying applications vault-k8s
[32mINFO    [0m pytest_operator.plugin:plugin.py:1030    Destroying applications vault-b
[32mINFO    [0m pytest_operator.plugin:plugin.py:1046 Not waiting on reset to complete.
[32mINFO    [0m pytest_operator.plugin:plugin.py:1017 Forgetting model main...