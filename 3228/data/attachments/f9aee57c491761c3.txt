[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  vault-k8s/0 [executing] active: 
  vault-k8s/1 [executing] active: 
  vault-k8s/2 [executing] active: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  tls-certificates-requirer/0 [executing] active: Certificate relation is created
[32mINFO    [0m pytest_operator.plugin:plugin.py:937 Model status:

Model          Controller                Cloud/Region        Version  SLA          Timestamp
test-pki-3d9h  github-pr-cccd3-microk8s  microk8s/localhost  3.6.8    unsupported  05:38:26Z

App                        Version  Status  Scale  Charm                      Channel        Rev  Address         Exposed  Message
self-signed-certificates            active      1  self-signed-certificates   1/stable       317  10.152.183.160  no       
tls-certificates-requirer           active      1  tls-certificates-requirer  latest/stable   93  10.152.183.168  no       Unit certificate is available
vault-k8s                           active      3  vault-k8s                                   0  10.152.183.182  no       

Unit                          Workload  Agent  Address       Ports  Message
self-signed-certificates/0*   active    idle   10.1.169.147         
tls-certificates-requirer/0*  active    idle   10.1.169.152         Unit certificate is available
vault-k8s/0                   active    idle   10.1.169.153         
vault-k8s/1*                  active    idle   10.1.169.150         
vault-k8s/2                   active    idle   10.1.169.154         

[32mINFO    [0m pytest_operator.plugin:plugin.py:943 Juju error logs:

unit-vault-k8s-0: 05:36:29 ERROR unit.vault-k8s/0.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-0.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f9ea98aaa80>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-0: 05:36:30 ERROR unit.vault-k8s/0.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-0.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fe9d9d3b290>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-2: 05:36:31 ERROR unit.vault-k8s/2.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f465f9a3200>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-0: 05:36:32 ERROR unit.vault-k8s/0.juju-log vault-peers:0: [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-0.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc04753b290>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-2: 05:36:32 ERROR unit.vault-k8s/2.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f430f2ef170>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-2: 05:36:34 ERROR unit.vault-k8s/2.juju-log vault-peers:0: [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-3d9h.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fd99393b410>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-self-signed-certificates-0: 05:37:26 ERROR unit.self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:37:39 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:37:41 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:37:43 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:37:46 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:37:53 ERROR unit.self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 05:38:18 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'

[32mINFO    [0m pytest_operator.plugin:plugin.py:1049 Resetting model test-pki-3d9h...
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications vault-k8s
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications self-signed-certificates
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications tls-certificates-requirer
[32mINFO    [0m pytest_operator.plugin:plugin.py:1054 Not waiting on reset to complete.
[32mINFO    [0m pytest_operator.plugin:plugin.py:1025 Forgetting model main...
[1m[31mERROR   [0m asyncio:base_events.py:1821 _GatheringFuture exception was never retrieved
future: <_GatheringFuture finished exception=NoConnectionException('not connected')>
Traceback (most recent call last):
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 3158, in wait_for_idle
    if app_name not in self.applications:
                       ^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 1184, in applications
    return self.state.applications
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 209, in applications
    return self._live_entity_map("application")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 198, in _live_entity_map
    entity_id: self.get_entity(entity_type, entity_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 311, in get_entity
    return entity_class(
           ^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 348, in __init__
    self.connection = model.connection()
                      ^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 697, in connection
    return self._connector.connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/client/connector.py", line 62, in connection
    raise NoConnectionException("not connected")
juju.client.connector.NoConnectionException: not connected