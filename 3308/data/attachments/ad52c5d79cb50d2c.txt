[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  tls-certificates-requirer/0 [executing] active: Certificate relation is created
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  vault-k8s/0 [executing] active: 
  vault-k8s/1 [executing] active: 
  vault-k8s/2 [executing] active:
[32mINFO    [0m pytest_operator.plugin:plugin.py:937 Model status:

Model          Controller                Cloud/Region        Version  SLA          Timestamp
test-pki-zobn  github-pr-fad43-microk8s  microk8s/localhost  3.6.8    unsupported  13:57:41Z

App                        Version  Status  Scale  Charm                      Channel        Rev  Address         Exposed  Message
self-signed-certificates            active      1  self-signed-certificates   1/stable       317  10.152.183.173  no       
tls-certificates-requirer           active      1  tls-certificates-requirer  latest/stable   93  10.152.183.150  no       Unit certificate is available
vault-k8s                           active      3  vault-k8s                                   0  10.152.183.115  no       

Unit                          Workload  Agent  Address      Ports  Message
self-signed-certificates/0*   active    idle   10.1.63.212         
tls-certificates-requirer/0*  active    idle   10.1.63.215         Unit certificate is available
vault-k8s/0*                  active    idle   10.1.63.208         
vault-k8s/1                   active    idle   10.1.63.218         
vault-k8s/2                   active    idle   10.1.63.217         

[32mINFO    [0m pytest_operator.plugin:plugin.py:943 Juju error logs:

unit-vault-k8s-2: 13:55:48 ERROR unit.vault-k8s/2.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fa7b21a8aa0>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-1: 13:55:49 ERROR unit.vault-k8s/1.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-1.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f3fa5468a40>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-2: 13:55:50 ERROR unit.vault-k8s/2.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f4f2dee06e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-1: 13:55:51 ERROR unit.vault-k8s/1.juju-log [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-1.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fc60c12c6e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-2: 13:55:51 ERROR unit.vault-k8s/2.juju-log vault-peers:0: [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-2.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f1c30ee4290>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-vault-k8s-1: 13:55:52 ERROR unit.vault-k8s/1.juju-log vault-peers:0: [vault_client] Error while checking Vault health status: HTTPSConnectionPool(host='vault-k8s-1.vault-k8s-endpoints.test-pki-zobn.svc.cluster.local', port=8200): Max retries exceeded with url: /v1/sys/health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f2415b30050>: Failed to establish a new connection: [Errno 111] Connection refused'))
unit-self-signed-certificates-0: 13:56:45 ERROR unit.self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:56:54 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:56:55 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:56:58 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:57:01 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:57:06 ERROR unit.self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-self-signed-certificates-0: 13:57:31 ERROR unit.self-signed-certificates/0.juju-log certificates:1: At least 1 matching relation ID not found with the relation name 'send-ca-cert'

[32mINFO    [0m pytest_operator.plugin:plugin.py:1049 Resetting model test-pki-zobn...
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications vault-k8s
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications self-signed-certificates
[32mINFO    [0m pytest_operator.plugin:plugin.py:1038    Destroying applications tls-certificates-requirer
[32mINFO    [0m pytest_operator.plugin:plugin.py:1054 Not waiting on reset to complete.
[32mINFO    [0m pytest_operator.plugin:plugin.py:1025 Forgetting model main...
[33mWARNING [0m juju.client.connection:connection.py:579 RPC: Connection closed, reconnecting
[33mWARNING [0m juju.client.connection:connection.py:579 RPC: Connection closed, reconnecting
[33mWARNING [0m juju.client.connection:connection.py:579 RPC: Connection closed, reconnecting
[31m[1mERROR   [0m juju.client.connection:connection.py:587 RPC: Automatic reconnect failed
[31m[1mERROR   [0m juju.client.connection:connection.py:587 RPC: Automatic reconnect failed
[31m[1mERROR   [0m juju.client.connection:connection.py:587 RPC: Automatic reconnect failed
[31m[1mERROR   [0m asyncio:base_events.py:1821 _GatheringFuture exception was never retrieved
future: <_GatheringFuture finished exception=ConnectionClosedOK(Close(code=1000, reason=''), Close(code=1000, reason=''), False)>
Traceback (most recent call last):
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/model/__init__.py", line 3162, in wait_for_idle
    app_status = await app.get_status()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/application.py", line 559, in get_status
    full_status = await client_facade.FullStatus(patterns=None)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py", line 482, in wrapper
    reply = await f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/client/_client8.py", line 35, in FullStatus
    reply = await self.rpc(msg)
            ^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/client/facade.py", line 680, in rpc
    result = await self.connection.rpc(msg, encoder=TypeEncoder)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 574, in rpc
    await self._ws.send(outgoing)
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py", line 476, in send
    async with self.send_context():
  File "/usr/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/vault-k8s-operator/vault-k8s-operator/k8s/.tox/integration/lib/python3.12/site-packages/websockets/asyncio/connection.py", line 957, in send_context
    raise self.protocol.close_exc from original_exc
websockets.exceptions.ConnectionClosedOK: sent 1000 (OK); then received 1000 (OK)